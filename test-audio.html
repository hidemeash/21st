<!DOCTYPE html>
<html>
<head>
    <title>Audio Test</title>
</head>
<body>
    <h1>Audio Test</h1>
    <audio id="testAudio" src="music.mp3" controls loop></audio>
    <br><br>
    <button onclick="playAudio()">Play Audio</button>
    <button onclick="testWebAudio()">Test Web Audio</button>
    
    <script>
        const audio = document.getElementById('testAudio');
        
        function playAudio() {
            console.log('Testing HTML5 audio...');
            audio.play().then(() => {
                console.log('HTML5 audio works!');
            }).catch(e => {
                console.log('HTML5 audio failed:', e);
            });
        }
        
        function testWebAudio() {
            console.log('Testing Web Audio API...');
            try {
                const AudioContextClass = window.AudioContext || window.webkitAudioContext;
                const audioContext = new AudioContextClass();
                
                if (audioContext.state === 'suspended') {
                    audioContext.resume().then(() => {
                        console.log('Audio context resumed');
                        const source = audioContext.createMediaElementSource(audio);
                        source.connect(audioContext.destination);
                        audio.play().then(() => {
                            console.log('Web Audio works!');
                        }).catch(e => {
                            console.log('Web Audio failed:', e);
                        });
                    });
                } else {
                    const source = audioContext.createMediaElementSource(audio);
                    source.connect(audioContext.destination);
                    audio.play().then(() => {
                        console.log('Web Audio works!');
                    }).catch(e => {
                        console.log('Web Audio failed:', e);
                    });
                }
            } catch (e) {
                console.log('Web Audio setup failed:', e);
            }
        }
        
        // Auto-test on load
        window.addEventListener('load', () => {
            console.log('Page loaded, testing audio...');
            setTimeout(playAudio, 1000);
        });
    </script>
</body>
</html>
